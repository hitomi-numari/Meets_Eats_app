<div class="top_container">
  <% if @genre.present? %>
    <h1 class="text-center"><%= @genre.name %></h1>
  <% elsif @area.present? %>
    <h1 class="text-center"><%= @area.name %></h1>
  <% else %>
    <h1 class="text-center">イベント一覧</h1>
  <% end %>
</div>
<div class="container">
  <div class="search_top">
    <!-- モーダル表示用のボタン -->
    <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">詳細検索</button>
    <!-- モーダル -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
            <h4 class="modal-title" id="myModalLabel">詳細検索</h4>
          </div>
          <div class="modal-body">
            <%= search_form_for @q do |f| %>
            <div class="search_container panel panel-default">
              <div class="panel-heading"><%= f.label 'タイトル検索' %></div>
                <div class="panel-body"><%= f.search_field :title_cont %></div>
            </div>
            <div class="search_container panel panel-default">
              <div class="panel-heading"><%= f.label '料理ジャンル' %></div>
                <div class="panel-body"><%= f.select :food_category_eq, [['イタリアン', 0], ['和食', 1], ['洋食', 2], ['中華', 3], ['その他', 4]], include_blank: '以下から選んでください' %></div>
            </div>
            <div class="search_container panel panel-default">
              <div class="panel-heading"><%= f.label "エリア" %></div>
                <div class="panel-body"><%= f.select :area_id_eq, options_from_collection_for_select(Area.all, :id, :name), include_blank: '以下から選んでください'%></div>
            </div>
                <%#= f.select :user_profile_gender_eq, options_from_collection_for_select(Profile.all, :id, :gender ) %>
                <%#= f.select :user_profile_birthday_eq, options_from_collection_for_select(Profile.all, :id, :birthday ) %>
            <div class="panel-body"><%= f.submit "検索" %></div>
              <% end %>
          </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
      </div>
    </div>
    <div class="new_post">
        <% if @genre.present? %>
          <div<%= link_to 'イベントを登録する', new_event_path(genre_id: @genre.id), class:"btn-gradation" %></div>
        <% elsif @area.present? %>
          <div><%= link_to 'イベントを登録する', new_event_path(area_id: @area.id), class:"btn-gradation" %></div>
        <% else %>
          <div><%= link_to 'イベントを登録する', new_event_path, class:"btn-gradation" %></div>
        <% end %>
    </div>
<% @events.each do |event| %>
  <div class="list-group">
    <div class="list-group-item">
      <div class="media">
        <div class="media-left col-xs-2">
          <%= image_tag(event.user.profile.icon_url, class: "center-block img-circle" ) %>
            <div class="profile">
              <h3><%=event.user.profile.nickname %></h3>
              <h4><%=event.user.profile.calc_age %>歳</h4>
              <h4><%=gender_view(event.user.profile.gender) %></h4>
            </div>
        </div>
        <div class="media-body">
          <ul class="top-contents">
            <li class="top-contents_item">
              <% event.genre_tags.each do |genre| %>
                <span class="label label-default"><%=genre.genre.name %></span>
              <% end %>
            </li>
            <li class="top-contents_item">
              <div class="schedule_time">
                <h3><%= simple_time_start_at(event.start_at) %>~<%= simple_time_end_at(event.end_at) %><h3>
              </div>
              <div class="required_time">
                <p>所要時間：<%= event.required_time %>時間</p>
              </div>
              <div class="check_in_time">
                <p>受付終了時間：<%= event.check_in_time_i18n %></p>
              </div>
            </li>
          </ul>
          <div class="middle-contents">
            <div class="title">
              <h3><%=event.title %></h3>
            </div>
            <p><%=event.content %></p>
            <div class="restaurant_url">
              <p><%= link_to event.restaurant_url %></p>
            </div>
              <ul class="restaurant_info">
                <li><%=event.area.name %></li>/
                <li><%=event.food_category_i18n %><li>/
                <li>予算：<%= event.budget_i18n %></li>
              </ul>
            <div class="bottom_contents">
              <%# unless event.user_id == current_user.id %>
                <%# if picture.favorite_users.ids == current_user.id %>
                <%#= link_to favorite_path(id: picture.favorites.ids), method: :delete do %>
                <i class="fas fa-heart"></i>
                <%# end %>
              <%# else %>
                <%#= link_to favorites_path(picture_id: picture.id), method: :post do %>
                  <i class="far fa-heart"></i>
                <%# end %>
              <%# end %>
            <%# end %>
              <strong class="pull-left">いいね！<%#= picture.favorite_users.count %>件</strong>
              <ul class="links pull-right">
                <li><%= link_to event_path(event.id), method: :get do %></li>
                  <i class="fa fa-info-circle"></i>
                <% end %>
                <% if event.user == current_user %>
                  <li><%= link_to edit_event_path(event.id), method: :get do %></li>
                    <i class="fa fa-edit"></i>
                  <% end %>
                  <li><%= link_to event_path(event.id), method: :delete, data: { confirm: 'Are you sure?' }, method: :delete do %></li>
                    <i class="fa fa-trash"></i>
                  <% end %>
                <% end %>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>
</div>
